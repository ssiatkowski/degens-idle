// --- SKILLS DATA ---
window.skills = [
    {
      id: 1001,
      name: "Unlock Sea World Realm",
      description: "Black Hole pokes and Merchants can now give cards from Sea World realm.",
      cost: { realmId: 1, currencyId: "stone", amount: 5e4 },
      purchased: false
    },
    {
      id: 1002,
      name: "Unlock Bugdom Realm",
      description: "Black Hole pokes and Merchants can now give cards from Bugdom realm.",
      cost: { realmId: 2, currencyId: "coral", amount: 1e5 },
      purchased: false
    },
    {
      id: 1003,
      name: "Unlock Aviary Realm",
      description: "Black Hole pokes and Merchants can now give cards from Aviary realm.",
      cost: { realmId: 3, currencyId: "pollen", amount: 2e5 },
      purchased: false
    },
    {
      id: 1004,
      name: "Unlock Ancient Relics Realm",
      description: "Black Hole pokes and Merchants can now give cards from Ancient Relics realm.",
      cost: { realmId: 4, currencyId: "egg", amount: 3e5 },
      purchased: false
    },
    {
      id: 1005,
      name: "Unlock Celestial Bodies Realm",
      description: "Black Hole pokes and Merchants can now give cards from Celestial Bodies realm.",
      cost: { realmId: 5, currencyId: "crystal", amount: 4e5 },
      purchased: false
    },
    {
      id: 2001,
      name: "More Cards",
      description: "+2 to max cards per poke.",
      cost: { realmId: 1, currencyId: "stone", amount: 5e3 },
      purchased: false
    },
    {
      id: 2002,
      name: "More Cards 2",
      description: "+5 to max cards per poke.",
      cost: { realmId: 2, currencyId: "coral", amount: 1e4 },
      purchased: false
    },
    {
      id: 2003,
      name: "More Cards 3",
      description: "+8 to max cards per poke.",
      cost: { realmId: 3, currencyId: "pollen", amount: 1.5e4 },
      purchased: false
    },
    {
      id: 2004,
      name: "More Cards 4",
      description: "+10 to max cards per poke.",
      cost: { realmId: 4, currencyId: "egg", amount: 2e4 },
      purchased: false
    },
    {
      id: 2005,
      name: "More Cards 5",
      description: "+15 to max cards per poke.",
      cost: { realmId: 1, currencyId: "rune", amount: 5e3 },
      purchased: false
    },
    {
      id: 2006,
      name: "More Cards 6",
      description: "+20 to max cards per poke.",
      cost: { realmId: 2, currencyId: "pearl", amount: 1e4 },
      purchased: false
    },
    {
      id: 2007,
      name: "More Cards 7",
      description: "+25 to max cards per poke.",
      cost: { realmId: 3, currencyId: "royal_jelly", amount: 1.5e4 },
      purchased: false
    },
    {
      id: 2008,
      name: "More Cards 8",
      description: "+30 to max cards per poke.",
      cost: { realmId: 4, currencyId: "feather", amount: 2e4 },
      purchased: false
    },
    {
      id: 2009,
      name: "More Cards 9",
      description: "+35 to max cards per poke.",
      cost: { realmId: 5, currencyId: "crystal", amount: 2.5e4 },
      purchased: false
    },
    {
      id: 2010,
      name: "More Cards 10",
      description: "+40 to max cards per poke.",
      cost: { realmId: 6, currencyId: "cosmic_ray", amount: 3e4 },
      purchased: false
    },
    {
      id: 2101,
      name: "Massive Black Hole",
      description: "+10 to max cards per poke.",
      cost: { realmId: 1, currencyId: "stone", amount: 1e7 },
      purchased: false
    },
    {
      id: 2102,
      name: "Massive Black Hole 2",
      description: "+20 to max cards per poke.",
      cost: { realmId: 2, currencyId: "coral", amount: 2e7 },
      purchased: false
    },
    {
      id: 2103,
      name: "Massive Black Hole 3",
      description: "+50 to max cards per poke.",
      cost: { realmId: 3, currencyId: "pollen", amount: 3e7 },
      purchased: false
    },
    {
      id: 2104,
      name: "Massive Black Hole 4",
      description: "+100 to max cards per poke.",
      cost: { realmId: 4, currencyId: "egg", amount: 4e7 },
      purchased: false
    },
    {
      id: 2105,
      name: "Massive Black Hole 5",
      description: "+150 to max cards per poke.",
      cost: { realmId: 3, currencyId: "rune", amount: 1e6 },
      purchased: false
    },
    {
      id: 2106,
      name: "Massive Black Hole 6",
      description: "+200 to max cards per poke.",
      cost: { realmId: 5, currencyId: "crystal", amount: 5e6 },
      purchased: false
    },
    {
      id: 2107,
      name: "Massive Black Hole 7",
      description: "+300 to max cards per poke.",
      cost: { realmId: 5, currencyId: "pearl", amount: 3e6 },
      purchased: false
    },
    {
      id: 2108,
      name: "Massive Black Hole 8",
      description: "+400 to max cards per poke.",
      cost: { realmId: 5, currencyId: "royal_jelly", amount: 4e6 },
      purchased: false
    },
    {
      id: 2109,
      name: "Massive Black Hole 9",
      description: "+500 to max cards per poke.",
      cost: { realmId: 6, currencyId: "feather", amount: 5e6 },
      purchased: false
    },
    {
      id: 2110,
      name: "Massive Black Hole 10",
      description: "+600 to max cards per poke.",
      cost: { realmId: 6, currencyId: "cosmic_ray", amount: 6e6 },
      purchased: false
    },
    {
      id: 3001,
      name: "Faster Poke",
      description: "Decrease base cooldown for Rocks by 0.5s.",
      cost: { realmId: 1, currencyId: "stone", amount: 1000 },
      purchased: false
    },
    {
      id: 3002,
      name: "Faster Poke 2",
      description: "Decrease base cooldown for Sea World by 2s.",
      cost: { realmId: 2, currencyId: "coral", amount: 2000 },
      purchased: false
    },
    {
      id: 3003,
      name: "Faster Poke 3",
      description: "Decrease base cooldown for Bugdom by 5s.",
      cost: { realmId: 3, currencyId: "pollen", amount: 3000 },
      purchased: false
    },
    {
      id: 3004,
      name: "Faster Poke 4",
      description: "Decrease base cooldown for Aviary by 10s.",
      cost: { realmId: 4, currencyId: "egg",  amount: 4000 },
      purchased: false
    },
    {
      id: 3005,
      name: "Faster Poke 5",
      description: "Decrease base cooldown for Ancient Relics by 15s.",
      cost: { realmId: 5, currencyId: "crystal", amount: 5000 },
      purchased: false
    },
    {
      id: 3006,
      name: "Faster Poke 6",
      description: "Decrease base cooldown for Celestial Bodies by 20s.",
      cost: { realmId: 6, currencyId: "rune", amount: 6000 },
      purchased: false
    },
    {
      id: 3101,
      name: "Even Faster Poke",
      description: "Decrease base cooldown for Rocks by 0.5s.",
      cost: { realmId: 3, currencyId: "pollen", amount: 1e5},
      purchased: false
    },
    {
      id: 3102,
      name: "Even Faster Poke 2",
      description: "Decrease base cooldown for Sea World by 2s.",
      cost: { realmId: 4, currencyId: "egg", amount: 2e5},
      purchased: false
    },
    {
      id: 3103,
      name: "Even Faster Poke 3",
      description: "Decrease base cooldown for Bugdom by 5s.",
      cost: { realmId: 5, currencyId: "crystal", amount: 1e6 },
      purchased: false
    },
    {
      id: 3104,
      name: "Even Faster Poke 4",
      description: "Decrease base cooldown for Aviary by 10s.",
      cost: { realmId: 6, currencyId: "rune", amount: 1e7 },
      purchased: false
    },
    {
      id: 4001,
      name: "Not Less Cards",
      description: "+1 to min cards per poke.",
      cost: { realmId: 1, currencyId: "stone", amount: 1e6 },
      purchased: false
    },
    {
      id: 4002,
      name: "Not Less Cards 2",
      description: "+2 to min cards per poke.",
      cost: { realmId: 2, currencyId: "coral", amount: 1e6 },
      purchased: false
    },
    {
      id: 4003,
      name: "Not Less Cards 3",
      description: "+3 to min cards per poke.",
      cost: { realmId: 3, currencyId: "pollen", amount: 1e6 },
      purchased: false
    },
    {
      id: 4004,
      name: "Not Less Cards 4",
      description: "+4 to min cards per poke.",
      cost: { realmId: 4, currencyId: "egg", amount: 1e6 },
      purchased: false
    },
    {
      id: 4005,
      name: "Not Less Cards 5",
      description: "+2 to min cards per poke.",
      cost: { realmId: 3, currencyId: "rune", amount: 1e6 },
      purchased: false
    },
    {
      id: 4006,
      name: "Not Less Cards 6",
      description: "+4 to min cards per poke.",
      cost: { realmId: 4, currencyId: "pearl", amount: 1e6 },
      purchased: false
    },
    {
      id: 4007,
      name: "Not Less Cards 7",
      description: "+6 to min cards per poke.",
      cost: { realmId: 5, currencyId: "royal_jelly", amount: 1e6 },
      purchased: false
    },
    {
      id: 4008,
      name: "Not Less Cards 8",
      description: "+8 to min cards per poke.",
      cost: { realmId: 5, currencyId: "feather", amount: 1e6 },
      purchased: false
    },
    {
      id: 4009,
      name: "Not Less Cards 9",
      description: "+10 to min cards per poke.",
      cost: { realmId: 5, currencyId: "crystal", amount: 1e6 },
      purchased: false
    },
    {
      id: 4010,
      name: "Not Less Cards 10",
      description: "+12 to min cards per poke.",
      cost: { realmId: 6, currencyId: "cosmic_ray", amount: 1e6 },
      purchased: false
    },
    {
      id: 5001,
      name: "Nobody Likes Rocks",
      description: "Rocks realm deselect multiplier reduced by 50%.",
      cost: { realmId: 2, currencyId: "stone", amount: 1e8 },
      purchased: false
    },
    {
      id: 5002,
      name: "The Sea Scares Me",
      description: "Sea World realm deselect multiplier reduced by 50%.",
      cost: { realmId: 3, currencyId: "coral", amount: 1e9 },
      purchased: false
    },
    {
      id: 5003,
      name: "To Hell with Bugs",
      description: "Bugdom realm deselect multiplier reduced by 50%.",
      cost: { realmId: 4, currencyId: "pollen", amount: 1e9 },
      purchased: false
    },
    {
      id: 5004,
      name: "Bird Aren't Real",
      description: "Aviary realm deselect multiplier reduced by 50%.",
      cost: { realmId: 5, currencyId: "egg", amount: 1e9 },
      purchased: false
    },
    {
      id: 5005,
      name: "Who Cares About Old Junk",
      description: "Ancient Relics realm deselect multiplier reduced by 50%.",
      cost: { realmId: 6, currencyId: "crystal", amount: 1e9 },
      purchased: false
    },
    {
      id: 6001,
      name: "Fan of Capitalism",
      description: "+1 card offered by merchants.",
      cost: { realmId: 1, currencyId: "stone", amount: 2e5 },
      purchased: false
    },
    {
      id: 6002,
      name: "Fan of Capitalism 2",
      description: "+1 card offered by merchants.",
      cost: { realmId: 2, currencyId: "coral", amount: 2e5 },
      purchased: false
    },
    {
      id: 6003,
      name: "Fan of Capitalism 3",
      description: "+1 card offered by merchants.",
      cost: { realmId: 3, currencyId: "pollen", amount: 2e5 },
      purchased: false
    },
    {
      id: 6004,
      name: "Fan of Capitalism 4",
      description: "+1 card offered by merchants.",
      cost: { realmId: 4, currencyId: "egg", amount: 2e5 },
      purchased: false
    },
    {
      id: 6005,
      name: "Fan of Capitalism 5",
      description: "+1 card offered by merchants.",
      cost: { realmId: 2, currencyId: "rune", amount: 2e5 },
      purchased: false
    },
    {
      id: 6006,
      name: "Fan of Capitalism 6",
      description: "+1 card offered by merchants.",
      cost: { realmId: 4, currencyId: "pearl", amount: 2e5 },
      purchased: false
    },
    {
      id: 6007,
      name: "Fan of Capitalism 7",
      description: "+1 card offered by merchants.",
      cost: { realmId: 3, currencyId: "royal_jelly", amount: 2e5 },
      purchased: false
    },
    {
      id: 6008,
      name: "Fan of Capitalism 8",
      description: "+1 card offered by merchants.",
      cost: { realmId: 5, currencyId: "feather", amount: 2e5 },
      purchased: false
    },
    {
      id: 6009,
      name: "Fan of Capitalism 9",
      description: "+1 card offered by merchants.",
      cost: { realmId: 5, currencyId: "crystal", amount: 2e5 },
      purchased: false
    },
    {
      id: 6010,
      name: "Fan of Capitalism 10",
      description: "+1 card offered by merchants.",
      cost: { realmId: 6, currencyId: "cosmic_ray", amount: 2e5 },
      purchased: false
    },
    {
      id: 7001,
      name: "Unlock New Merchant",
      description: "Yvette Ambervale is added to pool of traveling merchants.",
      cost: { realmId: 2, currencyId: "coral", amount: 3e5 },
      purchased: false
    },
    {
      id: 7002,
      name: "Unlock New Merchant 2",
      description: "Orin Saltstride is added to pool of traveling merchants.",
      cost: { realmId: 3, currencyId: "pollen", amount: 3e5 },
      purchased: false
    },
    {
      id: 7003,
      name: "Unlock New Merchant 3",
      description: "Petra Moonclasp is added to pool of traveling merchants.",
      cost: { realmId: 4, currencyId: "egg", amount: 3e5 },
      purchased: false
    },
    {
      id: 7004,
      name: "Unlock New Merchant 4",
      description: "Fergus Grainhand is added to pool of traveling merchants.",
      cost: { realmId: 5, currencyId: "crystal", amount: 3e5 },
      purchased: false
    },
    {
      id: 7005,
      name: "Unlock New Merchant 5",
      description: "Runa Frostpelt is added to pool of traveling merchants.",
      cost: { realmId: 6, currencyId: "stone", amount: 5e8 },
      purchased: false
    },
    // {
    //   id: 7006,
    //   name: "Unlock New Merchant 6",
    //   description: "Tobias Quickpouch is added to pool of traveling merchants.",
    //   cost: { realmId: 7, currencyId: "rune", amount: ? },
    //   purchased: false
    // },
    // {
    //   id: 7007,
    //   name: "Unlock New Merchant 7",
    //   description: "Selene Starwhistle is added to pool of traveling merchants.",
    //   cost: { realmId: 8, currencyId: "tooth", amount: ? },
    //   purchased: false
    // },
    {
      id: 8001,
      name: "Lucky Skip",
      description: "+1% chance to skip Black Hole cooldown.",
      cost: { realmId: 1, currencyId: "stone", amount: 5e4 },
      purchased: false
    },
    {
      id: 8002,
      name: "Lucky Skip 2",
      description: "+1% chance to skip Black Hole cooldown.",
      cost: { realmId: 2, currencyId: "coral", amount: 5e4 },
      purchased: false
    },
    {
      id: 8003,
      name: "Lucky Skip 3",
      description: "+1% chance to skip Black Hole cooldown.",
      cost: { realmId: 3, currencyId: "pollen", amount: 5e4 },
      purchased: false
    },
    {
      id: 8004,
      name: "Lucky Skip 4",
      description: "+1% chance to skip Black Hole cooldown.",
      cost: { realmId: 4, currencyId: "egg", amount: 5e4 },
      purchased: false
    },
    {
      id: 8005,
      name: "Lucky Skip 5",
      description: "+1% chance to skip Black Hole cooldown.",
      cost: { realmId: 2, currencyId: "rune", amount: 5e4 },
      purchased: false
    },
    {
      id: 8006,
      name: "Lucky Skip 6",
      description: "+1% chance to skip Black Hole cooldown.",
      cost: { realmId: 4, currencyId: "pearl", amount: 5e4 },
      purchased: false
    },
    {
      id: 8007,
      name: "Lucky Skip 7",
      description: "+1% chance to skip Black Hole cooldown.",
      cost: { realmId: 3, currencyId: "royal_jelly", amount: 5e4 },
      purchased: false
    },
    {
      id: 8008,
      name: "Lucky Skip 8",
      description: "+1% chance to skip Black Hole cooldown.",
      cost: { realmId: 4, currencyId: "feather", amount: 5e4 },
      purchased: false
    },
    {
      id: 8009,
      name: "Lucky Skip 9",
      description: "+1% chance to skip Black Hole cooldown.",
      cost: { realmId: 5, currencyId: "crystal", amount: 5e4 },
      purchased: false
    },
    {
      id: 8010,
      name: "Lucky Skip 10",
      description: "+1% chance to skip Black Hole cooldown.",
      cost: { realmId: 6, currencyId: "cosmic_ray", amount: 5e4 },
      purchased: false
    },
    {
      id: 9001,
      name: "Faster Merchant",
      description: "Reduce merchant refresh time by 5 seconds.",
      cost: { realmId: 1, currencyId: "stone", amount: 1.5e4 },
      purchased: false
    },
    {
      id: 9002,
      name: "Faster Merchant 2",
      description: "Reduce merchant refresh time by 5 seconds.",
      cost: { realmId: 2, currencyId: "coral", amount: 1.5e4 },
      purchased: false
    },
    {
      id: 9003,
      name: "Faster Merchant 3",
      description: "Reduce merchant refresh time by 5 seconds.",
      cost: { realmId: 3, currencyId: "pollen", amount: 1.5e4 },
      purchased: false
    },
    {
      id: 9004,
      name: "Faster Merchant 4",
      description: "Reduce merchant refresh time by 5 seconds.",
      cost: { realmId: 4, currencyId: "egg", amount: 1.5e4 },
      purchased: false
    },
    {
      id: 9005,
      name: "Faster Merchant 5",
      description: "Reduce merchant refresh time by 5 seconds.",
      cost: { realmId: 2, currencyId: "rune", amount: 1.5e4 },
      purchased: false
    },
    {
      id: 9006,
      name: "Faster Merchant 6",
      description: "Reduce merchant refresh time by 5 seconds.",
      cost: { realmId: 3, currencyId: "pearl", amount: 1.5e4 },
      purchased: false
    },
    {
      id: 9007,
      name: "Faster Merchant 7",
      description: "Reduce merchant refresh time by 5 seconds.",
      cost: { realmId: 4, currencyId: "royal_jelly", amount: 1.5e4 },
      purchased: false
    },
    {
      id: 9008,
      name: "Faster Merchant 8",
      description: "Reduce merchant refresh time by 5 seconds.",
      cost: { realmId: 4, currencyId: "feather", amount: 1.5e4 },
      purchased: false
    },
    {
      id: 9009,
      name: "Faster Merchant 9",
      description: "Reduce merchant refresh time by 5 seconds.",
      cost: { realmId: 5, currencyId: "crystal", amount: 1.5e4 },
      purchased: false
    },
    {
      id: 9010,
      name: "Faster Merchant 10",
      description: "Reduce merchant refresh time by 5 seconds.",
      cost: { realmId: 6, currencyId: "cosmic_ray", amount: 1.5e4 },
      purchased: false
    },
    {
      id: 10001,
      name: "Resource Generator",
      description: "Generate stone equal to number of Realm 1 cards discovered squared per second.",
      cost: { realmId: 2, currencyId: "coral", amount: 8e5 },
      purchased: false
    },
    {
      id: 10002,
      name: "Resource Generator 2",
      description: "Generate coral equal to number of Realm 2 cards discovered squared per second.",
      cost: { realmId: 3, currencyId: "pollen", amount: 8e5 },
      purchased: false
    },
    {
      id: 10003,
      name: "Resource Generator 3",
      description: "Generate pollen equal to number of Realm 3 cards discovered squared per second.",
      cost: { realmId: 4, currencyId: "egg", amount: 8e5 },
      purchased: false
    },
    {
      id: 10004,
      name: "Resource Generator 4",
      description: "Generate egg equal to number of Realm 4 cards discovered squared per second.",
      cost: { realmId: 5, currencyId: "crystal", amount: 8e5 },
      purchased: false
    },
    {
      id: 10005,
      name: "Resource Generator 5",
      description: "Generate crystal equal to number of Realm 5 cards discovered squared per second.",
      cost: { realmId: 6, currencyId: "rune", amount: 8e5 },
      purchased: false
    },
    {
      id: 11001,
      name: "Better Merchants",
      description: "Increase Merchant Rarity Scaling by 0.1.",
      cost: { realmId: 3, currencyId: "pollen", amount: 5e6 },
      purchased: false
    },
    {
      id: 11002,
      name: "Better Merchants 2",
      description: "Increase Merchant Rarity Scaling by 0.1.",
      cost: { realmId: 4, currencyId: "egg", amount: 5e6 },
      purchased: false
    },
    {
      id: 11003,
      name: "Better Merchants 3",
      description: "Increase Merchant Rarity Scaling by 0.1.",
      cost: { realmId: 5, currencyId: "crystal", amount: 5e6 },
      purchased: false
    },
    {
      id: 11004,
      name: "Better Merchants 4",
      description: "Increase Merchant Rarity Scaling by 0.1.",
      cost: { realmId: 6, currencyId: "rune", amount: 5e6 },
      purchased: false
    },
    {
      id: 12001,
      name: "Hawking Radiation Harvester",
      description: "Unlocks a device that can passively harvest Hawking radiation from the black hole to reduce its cooldown. (10x slower offline)",
      cost: { realmId: 2, currencyId: "coral", amount: 25000 },
      purchased: false
    },
    {
      id: 13001,
      name: "Anomaly",
      description: "Increases max cards per poke by 4.04.",
      cost: { realmId: 3, currencyId: "stone", amount: 404000 },
      purchased: false
    },
    {
      id: 13002,
      name: "Anomaly 2",
      description: "Increases min cards per poke by 4.04.",
      cost: { realmId: 4, currencyId: "coral", amount: 4.04e8 },
      purchased: false
    },
    {
      id: 13003,
      name: "Anomaly 3",
      description: "Reduce merchant refresh time by 4.04 seconds.",
      cost: { realmId: 6, currencyId: "pollen", amount: 4.04e11 },
      purchased: false
    },
  ];

  // --- PURCHASE LOGIC ---
function applySkill(id, skipCost = false) {
    const s = skillMap[id];
    if (!s || s.purchased) return;
  
    // 1) optionally pay
    if (!skipCost) {
      const cur    = state.currencies[s.cost.currencyId];
      const amount = new Decimal(s.cost.amount);
      if (cur.lessThan(amount)) return;
      state.currencies[s.cost.currencyId] = cur.minus(amount);
    }
  
    // 2) mark purchased
    s.purchased = true;
  
    // 3) apply its effect
    switch (s.id) {
      case 1001: // Unlock Sea World Realm
        realms[1].unlocked = true;
        initCardsFilters();
        renderRealmFilters();
        initializeSortedSkills();
        break;
      case 1002: // Unlock Bugdom Realm
        realms[2].unlocked = true;
        initCardsFilters();
        renderRealmFilters();
        initializeSortedSkills();
        break;
      case 1003: // Unlock Aviary Realm
        realms[3].unlocked = true;
        initCardsFilters();
        renderRealmFilters();
        initializeSortedSkills();
        break;
      case 1004: // Unlock Ancient Relics Realm
        realms[4].unlocked = true;
        initCardsFilters();
        renderRealmFilters();
        initializeSortedSkills();
        break;
      case 1005: // Unlock Celestial Bodies Realm
        realms[5].unlocked = true;
        initCardsFilters();
        renderRealmFilters();
        initializeSortedSkills();
        break;
      case 2001: // More Cards
        state.effects.maxCardsPerPoke += 2;
        break;
      case 2002:
        state.effects.maxCardsPerPoke += 5;
        break;
      case 2003:
        state.effects.maxCardsPerPoke += 8;
        break;
      case 2004:
        state.effects.maxCardsPerPoke += 10;
        break;
      case 2005:
        state.effects.maxCardsPerPoke += 15;
        break;
      case 2006:
        state.effects.maxCardsPerPoke += 20;
        break;
      case 2007:
        state.effects.maxCardsPerPoke += 25;
        break;
      case 2008:
        state.effects.maxCardsPerPoke += 30;
        break;
      case 2009:
        state.effects.maxCardsPerPoke += 35;
        break;
      case 2010:
        state.effects.maxCardsPerPoke += 40;
        break;
      case 2101: // Massive Black Hole
        state.effects.maxCardsPerPoke += 10;
        break;
      case 2102:
        state.effects.maxCardsPerPoke += 20;
        break;
      case 2103:
        state.effects.maxCardsPerPoke += 50;
        break;
      case 2104:
        state.effects.maxCardsPerPoke += 100;
        break;
      case 2105:
        state.effects.maxCardsPerPoke += 150;
        break;
      case 2106:
        state.effects.maxCardsPerPoke += 200;
        break;
      case 2107:
        state.effects.maxCardsPerPoke += 300;
        break;
      case 2108:
        state.effects.maxCardsPerPoke += 400;
        break;
      case 2109:
        state.effects.maxCardsPerPoke += 500;
        break;
      case 2110:
        state.effects.maxCardsPerPoke += 600;
        break;
      case 3001: // Faster Poke
        realms[s.cost.realmId - 1].cooldown -= 0.5;
        updatePokeFilterStats();
        renderRealmFilters();
        break;
      case 3002:
        realms[s.cost.realmId - 1].cooldown -= 2;
        updatePokeFilterStats();
        renderRealmFilters();
        break;
      case 3003:
        realms[s.cost.realmId - 1].cooldown -= 5;
        updatePokeFilterStats();
        renderRealmFilters();
        break;
      case 3004:
        realms[s.cost.realmId - 1].cooldown -= 10;
        updatePokeFilterStats();
        renderRealmFilters();
        break;
      case 3005:
        realms[s.cost.realmId - 1].cooldown -= 15;
        updatePokeFilterStats();
        renderRealmFilters();
        break;
      case 3006:
        realms[s.cost.realmId - 1].cooldown -= 20;
        updatePokeFilterStats();
        renderRealmFilters();
        break;
      case 3101: // Even Faster Poke
        realms[s.cost.realmId - 3].cooldown -= 0.5;
        updatePokeFilterStats();
        renderRealmFilters();
        break;
      case 3102:
        realms[s.cost.realmId - 3].cooldown -= 2;
        updatePokeFilterStats();
        renderRealmFilters();
        break;
      case 3103:
        realms[s.cost.realmId - 3].cooldown -= 5;
        updatePokeFilterStats();
        renderRealmFilters();
        break;
      case 3104:
        realms[s.cost.realmId - 3].cooldown -= 10;
        updatePokeFilterStats();
        renderRealmFilters();
        break;
      case 4001: // Not Less Cards
        state.effects.minCardsPerPoke += 1;
        break;
      case 4002:
        state.effects.minCardsPerPoke += 2;
        break;
      case 4003:
        state.effects.minCardsPerPoke += 3;
        break;
      case 4004:
        state.effects.minCardsPerPoke += 4;
        break;
      case 4005:
        state.effects.minCardsPerPoke += 2;
        break;
      case 4006:
        state.effects.minCardsPerPoke += 4;
        break;
      case 4007:
        state.effects.minCardsPerPoke += 6;
        break;
      case 4008:
        state.effects.minCardsPerPoke += 8;
        break;
      case 4009:
        state.effects.minCardsPerPoke += 10;
        break;
      case 4010:
        state.effects.minCardsPerPoke += 12;
        break;
      case 5001: // Nobody Likes Rocks
        realms[0].deselectMultiplier /= 2;
        updatePokeFilterStats();
        break;
      case 5002: // The Sea Scares Me
        realms[1].deselectMultiplier /= 2;
        updatePokeFilterStats();
        break;
      case 5003: // To Hell with Bugs
        realms[2].deselectMultiplier /= 2;
        updatePokeFilterStats();
        break;
      case 5004:
        realms[3].deselectMultiplier /= 2;
        updatePokeFilterStats();
        break;
      case 5005:
        realms[4].deselectMultiplier /= 2;
        updatePokeFilterStats();
        break;
      case 6001: // Merchant Card Increase
      case 6002:
      case 6003:
      case 6004:
      case 6005:
      case 6006:
      case 6007:
      case 6008:
      case 6009:
      case 6010:
        state.effects.merchantNumCards += 1;
        break;
      case 7001: // Unlock New Merchant
        unlockMerchantByName('Yvette Ambervale');
        break;
      case 7002: // Unlock New Merchant 2
        unlockMerchantByName('Orin Saltstride');
        break;
      case 7003: // Unlock New Merchant 3
        unlockMerchantByName('Petra Moonclasp');
        break;
      case 7004: // Unlock New Merchant 4
        unlockMerchantByName('Fergus Grainhand');
        break;
      case 7005: // Unlock New Merchant 5
        unlockMerchantByName('Runa Frostpelt');
        break;
      case 8001: // Lucky Skip
      case 8002: // Lucky Skip 2
      case 8003: // Lucky Skip 3
      case 8004: // Lucky Skip 4
      case 8005: // Lucky Skip 5
      case 8006: // Lucky Skip 6
      case 8007: // Lucky Skip 7
      case 8008: // Lucky Skip 8
      case 8009: // Lucky Skip 9
      case 8010: // Lucky Skip 10
        state.effects.cooldownSkipChance = (state.effects.cooldownSkipChance || 0) + 0.01;
        break;
      case 9001: // Merchant Cooldown Reduction
      case 9002:
      case 9003:
      case 9004:
      case 9005:
      case 9006:
      case 9007:
      case 9008:
      case 9009:
      case 9010:
        state.effects.merchantCooldownReduction += 5;
        break;
      case 10001: // Resource Generator
      case 10002:
      case 10003:
      case 10004:
      case 10005:
        updateGeneratorRates();
        break;
      case 11001: // Better Merchants
      case 11002: // Better Merchants 2
      case 11003: // Better Merchants 3
      case 11004: // Better Merchants 4
        state.effects.extraMerchantRarityScaling += 0.1;
        break;
      case 12001: // Hawking Radiation Harvester
        window.initHarvester();
        break;
      case 13001: // Anomaly
        state.effects.maxCardsPerPoke += 4.04;
        break;
      case 13002: // Anomaly 2
        state.effects.minCardsPerPoke += 4.04;
        break;
      case 13003: // Anomaly 3
        state.effects.merchantCooldownReduction += 4.04;
        break;
    }

    // Remove purchased skill from sortedSkillsByCurrency
    for (const currencyId in sortedSkillsByCurrency) {
      const list = sortedSkillsByCurrency[currencyId];
      const index = list.findIndex(s => s.id === id);
      if (index !== -1) {
        list.splice(index, 1);
        break;
      }
    }
  
    // 4) refresh UI
    renderSkillsTab();
    updateCurrencyBar();
}